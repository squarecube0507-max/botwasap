<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì¶ Editor de Productos - Bot WhatsApp</title>
    <link rel="stylesheet" href="css/productos.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <div class="header-content">
                <h1>üì¶ Gesti√≥n de Productos</h1>
                <div class="header-actions">
                    <button onclick="window.location.href='http://localhost:3001'" class="btn-secondary">
                        üè† Dashboard
                    </button>
                    <button onclick="mostrarModalNuevoProducto()" class="btn-primary">
                        ‚ûï Nuevo Producto
                    </button>
                </div>
            </div>
        </header>

        <!-- FILTROS -->
        <div class="filtros">
            <div class="filtro-busqueda">
                <input type="text" id="buscarProducto" placeholder="üîç Buscar productos..." onkeyup="filtrarProductos()">
            </div>
            <div class="filtro-categoria">
                <select id="filtroCategoria" onchange="filtrarProductos()">
                    <option value="">üìÅ Todas las categor√≠as</option>
                </select>
            </div>
            <div class="filtro-stock">
                <select id="filtroStock" onchange="filtrarProductos()">
                    <option value="">üì¶ Todo el stock</option>
                    <option value="con-stock">‚úÖ Con stock</option>
                    <option value="sin-stock">‚ùå Sin stock</option>
                </select>
            </div>
        </div>

        <!-- ESTAD√çSTICAS -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-icon">üì¶</div>
                <div class="stat-info">
                    <div class="stat-label">Total Productos</div>
                    <div class="stat-value" id="totalProductos">0</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-info">
                    <div class="stat-label">Categor√≠as</div>
                    <div class="stat-value" id="totalCategorias">0</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <div class="stat-label">Con Stock</div>
                    <div class="stat-value" id="totalConStock">0</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ùå</div>
                <div class="stat-info">
                    <div class="stat-label">Sin Stock</div>
                    <div class="stat-value" id="totalSinStock">0</div>
                </div>
            </div>
        </div>

        <!-- BOT√ìN AGREGAR CATEGOR√çA -->
        <div class="categoria-actions">
            <button onclick="mostrarModalNuevaCategoria()" class="btn-secondary">
                ‚ûï Nueva Categor√≠a
            </button>
        </div>

        <!-- LISTA DE PRODUCTOS POR CATEGOR√çA -->
        <div id="listaProductos" class="productos-container">
            <div class="loading">Cargando productos...</div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MODAL NUEVO/EDITAR PRODUCTO -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modalProducto" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="tituloModal">‚ûï Nuevo Producto</h2>
                <button class="btn-close" onclick="cerrarModal('modalProducto')">‚úï</button>
            </div>
            <form id="formProducto" onsubmit="guardarProducto(event)">
                <div class="form-group">
                    <label for="categoria">Categor√≠a *</label>
                    <select id="categoria" required>
                        <option value="">Seleccionar categor√≠a...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="subcategoria">Subcategor√≠a *</label>
                    <input type="text" id="subcategoria" placeholder="Ej: escolar, fiesta, etc." required>
                    <small style="color: #718096; display: block; margin-top: 5px; font-size: 13px;">
                        üí° Puedes usar espacios y may√∫sculas (se normalizar√°n autom√°ticamente)
                    </small>
                </div>

                <div class="form-group">
                    <label for="nombreProducto">Nombre del Producto *</label>
                    <input type="text" id="nombreProducto" placeholder="Ej: Cuaderno A4" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tipoPrecio">Tipo de Precio</label>
                        <select id="tipoPrecio" onchange="cambiarTipoPrecio()">
                            <option value="fijo">Precio Fijo</option>
                            <option value="desde">Precio Desde</option>
                        </select>
                    </div>

                    <div class="form-group" id="grupoPrecioFijo">
                        <label for="precio">Precio ($) *</label>
                        <input type="number" id="precio" placeholder="1500" step="0.01" min="0">
                    </div>

                    <div class="form-group" id="grupoPrecioDesde" style="display: none;">
                        <label for="precioDesde">Precio Desde ($) *</label>
                        <input type="number" id="precioDesde" placeholder="1500" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="unidad">Unidad (opcional)</label>
                        <input type="text" id="unidad" placeholder="c/u, x10, kg, etc.">
                    </div>

                    <div class="form-group">
                        <label for="stockProducto">Stock</label>
                        <select id="stockProducto">
                            <option value="true">‚úÖ Disponible</option>
                            <option value="false">‚ùå Sin stock</option>
                        </select>
                    </div>
                </div>

                <input type="hidden" id="productoId">

                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="cerrarModal('modalProducto')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary">
                        üíæ Guardar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MODAL NUEVA CATEGOR√çA -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modalCategoria" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚ûï Nueva Categor√≠a</h2>
                <button class="btn-close" onclick="cerrarModal('modalCategoria')">‚úï</button>
            </div>
            <form onsubmit="guardarCategoria(event)">
                <div class="form-group">
                    <label for="nombreCategoria">Nombre de la Categor√≠a *</label>
                    <input type="text" id="nombreCategoria" placeholder="Ej: Librer√≠a, Cotill√≥n" required>
                    <small style="color: #718096; display: block; margin-top: 5px; font-size: 13px;">
                        üí° Puedes usar espacios, may√∫sculas y tildes
                    </small>
                </div>

                <div class="form-group">
                    <label for="nombreSubcategoria">Primera Subcategor√≠a *</label>
                    <input type="text" id="nombreSubcategoria" placeholder="Ej: Escolar, Fiesta" required>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="cerrarModal('modalCategoria')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary">
                        ‚úÖ Crear
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MODAL EDITAR CATEGOR√çA -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modalEditarCategoria" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚úèÔ∏è Editar Categor√≠a</h2>
                <button class="btn-close" onclick="cerrarModal('modalEditarCategoria')">‚úï</button>
            </div>
            <form onsubmit="guardarNombreCategoria(event)">
                <input type="hidden" id="categoriaActualId">
                
                <div class="form-group">
                    <label>Nombre actual:</label>
                    <p id="categoriaActualNombre" style="font-weight: bold; color: #667eea; margin: 10px 0; padding: 10px; background: #f7fafc; border-radius: 6px;"></p>
                </div>
                
                <div class="form-group">
                    <label for="nuevoNombreCategoria">Nuevo nombre: *</label>
                    <input 
                        type="text" 
                        id="nuevoNombreCategoria" 
                        placeholder="Ej: Accesorios para Celular"
                        required
                    >
                    <small style="color: #718096; display: block; margin-top: 8px; font-size: 13px;">
                        üí° Puedes usar espacios, may√∫sculas y tildes. Se convertir√°n autom√°ticamente al formato correcto.
                    </small>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="cerrarModal('modalEditarCategoria')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary">
                        ‚úÖ Guardar Cambios
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- MODAL CONFIRMACI√ìN ELIMINAR -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modalEliminar" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirmar Eliminaci√≥n</h2>
                <button class="btn-close" onclick="cerrarModal('modalEliminar')">‚úï</button>
            </div>
            <div class="modal-body">
                <p id="mensajeEliminar"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="cerrarModal('modalEliminar')">
                    Cancelar
                </button>
                <button type="button" class="btn-danger" id="btnConfirmarEliminar">
                    üóëÔ∏è Eliminar
                </button>
            </div>
        </div>
    </div>

    <!-- NOTIFICACI√ìN -->
    <div id="notificacion" class="notificacion"></div>

    <script src="js/productos.js"></script>
</body>
</html>